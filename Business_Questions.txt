-- Q1. Find the top 10 best-value products based on the discount percentage.
SELECT DISTINCT name, mrp, discountPercent
FROM zepto
Order by discountPercent Desc
LIMIT 10;

-- Q2. What are the Products with High MRP but Out of Stock.
SELECT DISTINCT name, mrp
from zepto
WHERE outOfStock = TRUE and mrp > 300
ORDER BY mrp DESC;

-- Q3. Calculate Estimated Revenue for each category.
SELECT category,
sum(discountedSellingPrice * availableQuantity) As total_revenue
FROM zepto
group by category
order by  total_revenue;

-- Q4. Find all the products where MRP is greater than 500 and discount is less than 10%.
SELECT DISTINCT name, mrp, discountPercent
FROM zepto
Where mrp > 500 AND discountPercent < 10
Order by mrp desc, discountPercent DESC;

-- Q5. Identify the top 5 categories offering the highest average discount percentage.
SELECT category, ROUND(AVG(discountPercent),2) as avg_discount
from zepto
group by category
order by avg_discount DESC
LIMIT 5;

-- Q6. Find the price per gram for products above 100g and sort by best value.
SELECT DISTINCT name, weightInGms, discountedSellingPrice,
ROUND(discountedSellingPrice/weightInGms,2) AS price_per_gram
from zepto
WHERE weightInGms >= 100
ORDER by price_per_gram;

-- Q7. Group the products into categories like LOW, Medium, Bulk a/c to its weight.
SELECT DISTINCT name, weightInGms,
CASE WHEN weightInGms < 1000 THEN 'Low'
	WHEN weightINGMs < 5000 then 'Medium'
	ELSE 'Bulk'
	END AS weight_category
FROM zepto;


-- Q8. What is the total Inventory Weight Per Category.
SELECT category, SUM(weightInGms *availableQuantity) As total_weight
from zepto
group by category
order by total_weight;